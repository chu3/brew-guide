# 网页版字体缩放功能

## 功能概述

为了解决网页版没有字体大小设置的问题，我们实现了一个基于 CSS 自定义属性的字体缩放功能。这个功能与原生应用的字体缩放功能保持一致的用户体验。

## 技术实现

### 1. CSS 基础设置

在 `src/styles/base/globals.css` 中添加了字体缩放相关的 CSS 变量：

```css
:root {
  /* 网页版字体缩放变量 */
  --font-scale: 1;
  --base-font-size: 16px;
}

html {
  /* 动态字体大小：基础大小 × 缩放比例 */
  font-size: calc(var(--base-font-size) * var(--font-scale));
}
```

### 2. 字体缩放工具类

创建了 `src/lib/utils/webFontZoomUtils.ts` 工具类，提供以下功能：

- `isWebEnvironment()`: 检测是否为网页环境
- `getWebFontZoom()`: 获取当前字体缩放级别
- `setWebFontZoom(value)`: 设置字体缩放级别
- `initWebFontZoom()`: 初始化字体缩放设置
- `resetWebFontZoom()`: 重置到默认大小

### 3. 设置界面集成

在 `src/components/settings/Settings.tsx` 中：

- 添加了网页版字体缩放的状态管理
- 在设置界面中添加了字体大小调节滑块
- 只在网页环境中显示该设置项
- 与原生应用的文本缩放设置保持相同的 UI 风格

### 4. 应用初始化

在 `src/app/page.tsx` 中：

- 应用启动时自动初始化网页版字体缩放
- 从存储中恢复用户之前的字体大小设置
- 确保设置变更时同步更新字体大小

## 功能特点

### 1. 智能环境检测
- 自动检测是否为网页环境
- 原生应用显示原生字体缩放设置
- 网页版显示网页字体缩放设置
- 避免功能重复和冲突

### 2. 持久化存储
- 使用 localStorage 保存用户设置
- 页面刷新后自动恢复字体大小
- 与应用的其他设置统一管理

### 3. 实时生效
- 拖动滑块时字体大小立即变化
- 无需刷新页面
- 平滑的视觉过渡效果

### 4. 用户体验优化
- 缩放范围：0.8× - 1.4×（与原生应用一致）
- 提供"标准"快捷按钮一键重置
- 显示当前缩放倍数
- 包含使用说明文字

## 使用方法

1. 在网页版中打开设置页面
2. 找到"显示"分组下的"字体大小"设置
3. 拖动滑块调整字体大小
4. 点击"标准"按钮可快速重置为默认大小
5. 设置会自动保存，下次访问时生效

## 技术优势

### 1. 性能优秀
- 使用 CSS 变量，只需改变根元素字体大小
- 所有使用 rem 单位的元素自动缩放
- 避免了遍历 DOM 元素的性能开销

### 2. 兼容性好
- 基于标准的 CSS 自定义属性
- 支持所有现代浏览器
- 渐进增强，不影响旧浏览器基本功能

### 3. 维护性强
- 代码结构清晰，职责分离
- 与现有设置系统完美集成
- 易于扩展和修改

### 4. 用户友好
- 与原生应用保持一致的交互体验
- 设置项只在相应环境中显示
- 提供清晰的视觉反馈

## 未来扩展

可以考虑添加以下功能：

1. **预设字体大小**: 提供小、标准、大、超大等预设选项
2. **无障碍支持**: 响应系统的无障碍字体大小设置
3. **字体族选择**: 允许用户选择不同的字体
4. **行高调节**: 配合字体大小调节行高以优化阅读体验

## 总结

这个网页版字体缩放功能成功解决了网页版缺少字体大小设置的问题，通过现代 CSS 技术实现了高性能、用户友好的字体缩放体验，与原生应用保持了一致的功能和交互设计。
